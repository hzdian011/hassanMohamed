{% comment %}
  {% schema %}
  {
    "name": "Products Grid",
    "blocks": [
      {
        "type": "product",
        "name": "Product Block",
        "settings": [
          {
            "type": "product",
            "id": "product",
            "label": "Select a product"
          },
          {
            "type": "range",
            "id": "pos_x",
            "label": "X Position (%)",
            "min": 0,
            "max": 100,
            "default": 50
          },
          {
            "type": "range",
            "id": "pos_y",
            "label": "Y Position (%)",
            "min": 0,
            "max": 100,
            "default": 50
          }
        ]
      }
    ],
    "max_blocks": 6
  }
  {% endschema %}

  <section class="products-section">
    <!-- Title -->
    <h2 class="section-title">Tisso vision in the wild</h2>

    <div class="products-grid">
      {% for block in section.blocks %}
        {% assign product = all_products[block.settings.product] %}
        <div class="product-card">
          <div class="image-wrapper">
            <img src="{{ product.featured_image | img_url: '500x' }}" alt="{{ product.title }}" width="" height="">

            <!-- Ø²Ø±Ø§Ø± Ø§Ù„Ø¨Ù„Ø³ -->
            <button
              class="plus-btn"
              data-handle="{{ product.handle }}"
              style="top:{{ block.settings.pos_y }}%; left:{{ block.settings.pos_x }}%;"
            >
              +
            </button>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
    <div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>

          {% comment %} <!-- image -->
          <img id="modalImage" class="product-image" src="" alt="Product image" width="" height="">

          <!-- details -->
          <div class="modal-details">
            <h2 id="modalTitle"></h2>
            <p id="modalPrice"></p>
            <p id="modalDescription"></p>

            <div class="color-options">
              <label>Color</label>
              <div id="colorContainer"></div>
            </div>

            <div class="size-options">
              <label for="sizeSelect">Size</label>
              <select id="sizeSelect">
                <option>Choose your size</option>
              </select>
            </div>
          </div> {% endcomment %}

        <div class="modal-top">
            <!-- Ø§Ù„ØµÙˆØ±Ø© -->
            <img id="modalImage" class="product-image" src="" alt="Product image" width="" height="">

            <!-- Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
            <div class="basic-details">
              <h2 id="modalTitle"></h2>
              <p id="modalPrice"></p>
              <p id="modalDescription"></p>
            </div>
          </div>

          <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
          <div class="modal-details">
            <div class="color-options">
              <label>Color</label>
              <div id="colorContainer"></div>
            </div>

            {% comment %} <div class="size-options">
              <label for="sizeSelect">Size</label>
              <select id="sizeSelect">
                <option>Choose your size</option>
              </select>
            </div> {% endcomment %}

            <div class="size-options">
              <label>Size</label>
              <div class="custom-dropdown">
                <button id="sizeDropdownBtn" class="dropdown-btn">
                  Choose your size
                  <span class="chevron">&#9662;</span>
                </button>
                <div id="sizeDropdownList" class="dropdown-list"></div>
            </div>
  </div>

        </div>


        <button id="addToCartBtn">ADD TO CART â†’</button>
      </div>
    </div>
  </section>







  <style>
    /*================= New =============== */
    .modal-top {
    display: flex;
    align-items: flex-start; /* Ø§Ù„ØµÙˆØ±Ø© ÙÙˆÙ‚ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„ ØªØ¨Ø¯Ø£ Ø¬Ù†Ø¨Ù‡Ø§ */
    gap: 15px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„ */
  }

  .modal-top img.product-image {
    width: 160px;   /* ğŸŸ¢ Ø²ÙˆØ¯ Ø§Ù„Ø¹Ø±Ø¶ */
    height: auto;
    max-height: 220px; /* ğŸŸ¢ Ø§Ù„Ø·ÙˆÙ„ Ø£ÙƒØ¨Ø± */
    object-fit: cover;
    flex-shrink: 0;
  }

  .basic-details {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .basic-details h2 {
    font-size: 16px;
    margin: 0;
    font-weight: bold;
  }

  .basic-details p {
    margin: 0;
    font-size: 14px;
    color: #333;
  }









    /*================ ends ============== */
      .products-section {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 30px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù€ grid */
        max-width: 1337px;
        margin: 0 auto;
        padding: 80px 0px 50px 0px;
        overflow-y:hidden;
      }


      .section-title {
        font-family: 'Lustria', serif;
        font-weight: 400;
        font-size: 36px;
        line-height: 120%;
        color: #000;
        margin: 0;

        width: 100%;
        max-width: 100%; /* Ù†ÙØ³ Ø¹Ø±Ø¶ Ø§Ù„Ù€ grid */
        margin: 0 auto;   /* Ø¹Ø´Ø§Ù† ÙŠØ¨Ù‚Ù‰ aligned Ù…Ø¹ grid */
      }

      .products-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        max-width: 100%;
        {% comment %} margin: auto; {% endcomment %}
        margin: 0;
      }

      .product-card {
        text-align: center;
        width: 100%;
        height: 100%;
      }

      .image-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
        height: 100%;
      }

      .image-wrapper img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
    }

      .controls {
        margin-top: 10px;
      }

      .controls label {
        display: block;
        font-size: 12px;
        margin-bottom: 2px;
      }

      /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
      .modal {
        display: none;
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.5);
      }

      /* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
      .modal-content {
        background: #fff;
        margin: 8% auto;
        padding: 30px 20px;
        width: 340px;
        position: relative;
        box-shadow: 0px 2px 6px rgba(0,0,0,0.25);

        display: flex;
        flex-direction: column;
        gap: 18px;
        font-family: Arial, sans-serif;
      }

      /* Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ */
      .close {
        position: absolute;
        top: 10px; right: 15px;
        font-size: 20px;
        cursor: pointer;
      }

      /* ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
      {% comment %} .modal-content img.product-image {
        width: 100%;
        height: auto;
        border-radius: 6px;
      } {% endcomment %}

      /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ */
      .modal-details {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin: 20px 0;
      }

      .modal-details h2 {
        font-size: 16px;
        margin: 0;
        font-weight: normal;
      }

      .modal-details p {
        margin: 0;
        font-size: 14px;
        color: #333;
      }
      {% comment %} text {% endcomment %}
      #modalTitle{
          font-family: 'Jost', sans-serif;
        font-style: normal;
        font-weight: 300;
        font-size: 16px;
        line-height: 120%;
        /* or 19px */
        display: flex;
        align-items: center;
        color: #000000;
      }
      #modalDescription{
        font-weight:300;
          font-family: 'Jost', sans-serif;
        font-style: normal;
        font-weight: 300;
        font-size: 14px;
        line-height: 110%;
        letter-spacing: -0.01em;
        color: #000000;
      }
      #modalPrice{
        font-family: 'Lustria';
        font-style: normal;
        font-weight: 400;
        font-size: 16px;
        line-height: 120%;
        display: flex;
        align-items: center;
        color: #000000;
      }


      /* Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
      .color-options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .color-options label {
          font-family: 'Jost', sans-serif;
        font-style: normal;
        font-weight: 400;
        font-size: 14px;
        line-height: 130%;
        color: #333333;
      }

      #colorContainer {
        display: flex;
        gap: 10px;
      }

   /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
      .color-btn {
        flex: 1;
        padding: 8px;
        border: 1px solid #000;
        background: #fff;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s ease;
      }

      .color-btn.active {
        background: #000 !important;   /* ğŸŸ¢ Ø§Ù„Ø®Ù„ÙÙŠØ© ØªØ¨Ù‚Ù‰ Ø³ÙˆØ¯Ø§Ø¡ */
        color: #fff !important;        /* ğŸŸ¢ Ø§Ù„ÙƒØªØ§Ø¨Ø© ØªØ¨Ù‚Ù‰ Ø¨ÙŠØ¶Ø§ */
        border: 1px solid #000;
      }
      {% comment %} .color-btn.active {
        border-left: 4px solid blue;
      } {% endcomment %}

      /* Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ù‚Ø§Ø³ */
      .size-options {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .size-options label {
          font-family: 'Jost', sans-serif;
        font-style: normal;
        font-weight: 400;
        font-size: 14px;
        line-height: 130%;
        color: #333333;
      }

      .size-options select {
        padding: 8px;
        border: 1px solid #000;
        cursor: pointer;
      }

      /* Ø²Ø±Ø§Ø± Ø§Ù„ÙƒØ§Ø±Øª */
      #addToCartBtn {
        background: #000;
        color: #fff;
        border: none;
        padding: 14px;
        font-size: 14px;
        cursor: pointer;
        border-radius: 2px;
        margin-top: auto;
        width: 100%;
      }

      .image-wrapper img {
        width: 100%;
      }

      .plus-btn {
        position: absolute;
        transform: translate(-50%, -50%);
        background: white;
        border-radius: 50%;
        border:none;
        width: 25px;
        height: 25px;
        font-size: 15px;
        cursor: pointer;
      }
  </style>
  <script>
    let currentProduct = null; // ğŸŸ¢ Ù‡Ù†Ø®Ø²Ù† ÙÙŠÙ‡ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØªÙˆØ­ Ù…Ù† Ø§Ù„Ù…ÙˆØ¯Ø§Ù„

    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¨Ù„Ø³ Ø¨Ø§Ù„Ù€ range (Ù„Ùˆ Ù…Ø­ØªØ§Ø¬Ù‡Ø§)
    document.querySelectorAll('.range-x').forEach((input) => {
      input.addEventListener('input', () => {
        const handle = input.dataset.target;
        const btn = document.querySelector(`.plus-btn[data-handle="${handle}"]`);
        btn.style.left = input.value + '%';
      });
    });

    document.querySelectorAll('.range-y').forEach((input) => {
      input.addEventListener('input', () => {
        const handle = input.dataset.target;
        const btn = document.querySelector(`.plus-btn[data-handle="${handle}"]`);
        btn.style.top = input.value + '%';
      });
    });

    // ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„Ø³
    document.querySelectorAll('.plus-btn').forEach((btn) => {
      btn.addEventListener('click', async () => {
        const handle = btn.dataset.handle;
        const response = await fetch(`/products/${handle}.js`);
        const product = await response.json();

        // ğŸŸ¢ Ù†Ø®Ø²Ù† Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ù…ØªØºÙŠØ± Ø¬Ù„ÙˆØ¨Ø§Ù„
        currentProduct = product;

        // Ù†Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬
        document.getElementById('modalTitle').textContent = product.title;
        document.getElementById('modalPrice').textContent = product.price / 100 + ' â‚¬';
        document.getElementById('modalDescription').innerHTML = product.description;
        document.getElementById('modalImage').src = product.images[0];

        // ================== colors ==================
        const colorContainer = document.getElementById('colorContainer');
        colorContainer.innerHTML = '';

        const colorMap = {
          red: '#FF0000',
          blue: '#0000FF',
          green: '#00FF00',
          black: '#000000',
          white: '#FFFFFF',
          yellow: '#FFFF00',
          'sky blue': '#87CEEB',
          'light pink': '#FFB6C1',
        };

        const colorOption = product.options.find((opt) => opt.name.toLowerCase() === 'color');

        if (colorOption) {
          colorOption.values.forEach((color, i) => {
            const colorBtn = document.createElement('button');
            colorBtn.textContent = color;
            colorBtn.classList.add('color-btn');
            if (i === 0) colorBtn.classList.add('active');

            const normalizedColor = color.trim().toLowerCase();
            const cssColor = colorMap[normalizedColor] || '#000';

            colorBtn.addEventListener('click', () => {
              document.querySelectorAll('.color-btn').forEach((b) => {
                b.classList.remove('active');
                b.style.borderLeft = 'none';
              });

              colorBtn.classList.add('active');
              colorBtn.style.borderLeft = `4px solid ${cssColor}`;
            });

            colorContainer.appendChild(colorBtn);
          });
        }

        // ================== sizes ==================
        const sizeSelect = document.getElementById('sizeSelect');
        sizeSelect.innerHTML = '<option>Choose your size</option>';

        const sizeOption = product.options.find((opt) => opt.name.toLowerCase() === 'size');
        if (sizeOption) {
          sizeOption.values.forEach((size) => {
            let opt = document.createElement('option');
            opt.value = size;
            opt.textContent = size;
            sizeSelect.appendChild(opt);
          });
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        document.getElementById('myModal').style.display = 'block';
      });
    });

    // ğŸ›’ ÙØªØ­ Ø§Ù„ÙƒØ§Ø±Øª
    function openCartDrawer() {
      fetch('/cart.js')
        .then((res) => res.json())
        .then((cart) => {
          const cartItemsContainer = document.getElementById('cartItems');
          cartItemsContainer.innerHTML = '';

          cart.items.forEach((item) => {
            const div = document.createElement('div');
            div.classList.add('cart-item');
            div.innerHTML = `
              <img src="${item.image}" alt="${item.title}">
              <div class="cart-item-details">
                <h4>${item.product_title}</h4>
                <p>${item.variant_title || ''}</p>
                <p>Qty: ${item.quantity}</p>
                <p>${(item.line_price / 100).toFixed(2)} â‚¬</p>
              </div>
            `;
            cartItemsContainer.appendChild(div);
          });

          document.getElementById('cartDrawer').classList.add('active');
        });
    }

    // Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙƒØ§Ø±Øª
    document.getElementById('addToCartBtn').addEventListener('click', () => {
      if (!currentProduct) {
        alert('No product selected');
        return;
      }

      const selectedSize = document.getElementById('sizeSelect').value;
      const selectedColorBtn = document.querySelector('.color-btn.active');
      const selectedColor = selectedColorBtn ? selectedColorBtn.textContent : null;

      // Ù†Ø­Ø¯Ø¯ Ø§Ù„Ù€ variant ID
      const selectedVariant = currentProduct.variants.find((v) => {
        return (
          (!selectedColor || v.options.includes(selectedColor)) && (!selectedSize || v.options.includes(selectedSize))
        );
      });

      if (!selectedVariant) {
        alert('Please select options');
        return;
      }

      // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù€ cart
      fetch('/cart/add.js', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Accept: 'application/json' },
        body: JSON.stringify({ id: selectedVariant.id, quantity: 1 }),
      })
        .then((res) => res.json())
        .then(() => {
          openCartDrawer();
          document.getElementById('myModal').style.display = 'none';
        });
    });

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙƒØ§Ø±Øª
    document.getElementById('closeCart').addEventListener('click', () => {
      document.getElementById('cartDrawer').classList.remove('active');
    });

    // Ø§ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    document.querySelector('.close').addEventListener('click', () => {
      document.getElementById('myModal').style.display = 'none';
    });

    // ÙŠÙ‚ÙÙ„ Ù„Ùˆ Ø¶ØºØ·Øª Ø¨Ø±Ù‡ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    window.addEventListener('click', (e) => {
      const modal = document.getElementById('myModal');
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  </script>
{% endcomment %}

{% schema %}
{
  "name": "Products Grid",
  "blocks": [
    {
      "type": "product",
      "name": "Product Block",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select a product"
        },
        {
          "type": "range",
          "id": "pos_x",
          "label": "X Position (%)",
          "min": 0,
          "max": 100,
          "default": 50
        },
        {
          "type": "range",
          "id": "pos_y",
          "label": "Y Position (%)",
          "min": 0,
          "max": 100,
          "default": 50
        }
      ]
    }
  ],
  "max_blocks": 6
}
{% endschema %}

<section class="products-section">
  <!-- Title -->
  <h2 class="section-title">Tisso vision in the wild</h2>

  <div class="products-grid">
    {% for block in section.blocks %}
      {% assign product = all_products[block.settings.product] %}
      <div class="product-card">
        <div class="image-wrapper">
          <img src="{{ product.featured_image | img_url: '500x' }}" alt="{{ product.title }}" width="" height="">

          <!-- plus button -->
          <button
            class="plus-btn"
            data-handle="{{ product.handle }}"
            style="top:{{ block.settings.pos_y }}%; left:{{ block.settings.pos_x }}%;"
          >
            {% comment %} + {% endcomment %}
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="plus-icon"
            >
              <g filter="url(#filter0_d_5_3060)">
              <circle cx="11.8571" cy="8.85714" r="7.85714" fill="#F8F8F8" fill-opacity="0.9"/>
              <path d="M12.1045 6.02985V12.0738" stroke="black" stroke-linecap="square" stroke-linejoin="round"/>
              <path d="M9.08252 9.05182H15.1265" stroke="black" stroke-linecap="square" stroke-linejoin="round"/>
              </g>
              <defs>
              <filter id="filter0_d_5_3060" x="0" y="0" width="23.7144" height="23.7143" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dy="3"/>
              <feGaussianBlur stdDeviation="2"/>
              <feComposite in2="hardAlpha" operator="out"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/>
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_5_3060"/>
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_5_3060" result="shape"/>
              </filter>
              </defs>
            </svg>
          </button>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Modal -->
  <div id="myModal" class="modal">
    <div class="modal-content">
      {% comment %} <span class="close">&times</span>#samah {% endcomment %}
      <span class="close">
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="closeFromSvg"
        >
          <path d="M5.0376 4.94354L13.5229 13.4288" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
          <path d="M5.0376 13.4285L13.5229 4.94325" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
        </svg>
      </span>

      <div class="modal-top">
        <!-- image -->
        <img id="modalImage" class="product-image" src="" alt="Product image" width="" height="">

        <!-- basic details -->
        <div class="basic-details">
          <h2 id="modalTitle"></h2>
          <p id="modalPrice"></p>
          <p id="modalDescription"></p>
        </div>
      </div>

      <!-- extra details -->
      <div class="modal-details">
        <div class="color-options">
          <label>Color</label>
          <div id="colorContainer"></div>
        </div>

        <div class="size-options">
          <label>Size</label>
          <div class="custom-dropdown">
            <button id="sizeDropdownBtn" class="dropdown-btn">
              Choose your size
              <span class="chevron">
                <svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2 2L8 8L14 2" stroke="black" stroke-width="1.5" stroke-linecap="square"/>
                </svg>
              </span>
            </button>
            <div id="sizeDropdownList" class="dropdown-list"></div>
          </div>
        </div>
      </div>

      {% comment %} <button id="addToCartBtn">
        ADD TO CART
        <span class="addToCartBtn-icon">
            <svg width="36" height="12" viewBox="0 0 36 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1.4093 5.25L0.659302 5.25L0.659302 6.75L1.4093 6.75L1.4093 5.25ZM35.6391 6.53033C35.932 6.23744 35.932 5.76257 35.6391 5.46967L30.8661 0.696701C30.5733 0.403808 30.0984 0.403808 29.8055 0.696701C29.5126 0.989594 29.5126 1.46447 29.8055 1.75736L34.0481 6L29.8055 10.2426C29.5126 10.5355 29.5126 11.0104 29.8055 11.3033C30.0984 11.5962 30.5732 11.5962 30.8661 11.3033L35.6391 6.53033ZM1.4093 6.75L35.1088 6.75L35.1088 5.25L1.4093 5.25L1.4093 6.75Z" fill="white"/>
            </svg>
        </span>
      </button> {% endcomment %}
      <button id="addToCartBtn">
        <span class="addToCartBtn-text">ADD TO CART</span>
        <span class="addToCartBtn-icon">
          <svg width="36" height="12" viewBox="0 0 36 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.4093 5.25L0.659302 5.25L0.659302 6.75L1.4093 6.75L1.4093 5.25ZM35.6391 6.53033C35.932 6.23744 35.932 5.76257 35.6391 5.46967L30.8661 0.696701C30.5733 0.403808 30.0984 0.403808 29.8055 0.696701C29.5126 0.989594 29.5126 1.46447 29.8055 1.75736L34.0481 6L29.8055 10.2426C29.5126 10.5355 29.5126 11.0104 29.8055 11.3033C30.0984 11.5962 30.5732 11.5962 30.8661 11.3033L35.6391 6.53033ZM1.4093 6.75L35.1088 6.75L35.1088 5.25L1.4093 5.25L1.4093 6.75Z" fill="white"/>
          </svg>
        </span>
      </button>

    </div>
  </div>
</section>

<style>
  /*================= Modal Top =============== */
  .modal-top {
    display: flex;
    align-items: flex-start;
    gap: 15px;
  }

  .modal-top img.product-image {
    width: 136px;
    height: 161px;
    max-height: 300px;
    object-fit: cover;
    flex-shrink: 0;
  }

  .basic-details {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .basic-details h2 {
    font-size: 16px;
    margin: 0;
    font-weight: bold;
  }

  .basic-details p {
    margin: 0;
    font-size: 14px;
    color: #333;
    line-height: 1.2;
  }

  /*================= Section =============== */
  .products-section {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 30px;
    max-width: 1337px;
    margin: 0 auto;
    padding: 80px 0px 50px 0px;
    overflow-y: hidden;
  }

  .section-title {
    font-family: 'Lustria', serif;
    font-weight: 400;
    font-size: 36px;
    line-height: 120%;
    color: #000;
    margin: 0;
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin: 0;
  }

  .product-card {
    text-align: center;
    width: 100%;
    height: 100%;
  }

  .image-wrapper {
    position: relative;
    display: inline-block;
    width: 100%;
    height: 100%;
  }

  .image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /*================= Modal =============== */
  .modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
  }

  .modal-content {
    background: #fff;
    margin: 8% auto;
    padding: 45px 20px 30px 20px;
    width: 310px;
    position: relative;
    box-shadow: 0px 2px 6px rgba(0,0,0,0.25);

    display: flex;
    flex-direction: column;
    font-family: 'Jost', sans-serif;
  }

  .close {
    position: absolute;
    top: 10px; right: 15px;
    font-size: 20px;
    cursor: pointer;
  }

  .modal-details {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin: 20px 0;
  }

  #modalTitle{
    font-family: 'Jost', sans-serif;
    font-weight: 300;
    font-size: 16px;
    line-height: 120%;
    color: #000000;
    margin-top: 14px
  }
  #modalDescription{
      font-family: 'Jost', sans-serif;
    font-weight: 300;
    font-size: 14px;
    line-height: 110%;
    letter-spacing: -0.01em;
    color: #000000;
  }
  #modalPrice{
    font-family: 'Lustria';
    font-weight: 400;
    font-size: 20px;
    line-height: 120%;
    color: #000000;
    margin:16px 0px 3px 0px;
  }

  /*================= Color Options =============== */
  .color-options {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .color-options label {
     font-family: 'Jost', sans-serif;
    font-weight: 400;
    font-size: 15px;
    color: #333333;
  }

  .color-options .color-swatch {
    width: 40px;   /* ÙƒØ§Ù†Øª 30px Ø²ÙˆØ¯Ù†Ø§Ù‡Ø§ */
    height: 50px;  /* ÙƒØ§Ù†Øª 30px */
    border-radius: 50%;
    margin-right: 10px;
    cursor: pointer;
    border: 2px solid #ddd;
    {% comment %} transition: transform 0.2s, border 0.2s; {% endcomment %}
    transition: all 0.3s ease-in-out; /* Ø¨Ø¯Ù„ Ù…Ø§ ÙƒØ§Ù† transform + border */

  }

  .color-options .color-swatch:hover {
    transform: scale(1.15);
    border-color: #000;
  }


  #colorContainer {
    display: flex;
  }

  .color-btn {
    flex: 1;
    padding: 12px;
    border: 1px solid #000;
    background: #fff;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align:start;

    font-family: 'Jost', sans-serif;
    font-weight: 400;
    font-size: 18px;
    line-height: 100%;
    letter-spacing: -0.02em;
    text-transform: capitalize;
    color: #000000;

  }

  .color-btn.active {
    background: #000 !important;
    color: #fff !important;
    border: 1px solid #000;
    transition: all 0.1s ease-in-out; /* Ø¨Ø¯Ù„ Ù…Ø§ ÙƒØ§Ù† transform + border */
  }

  /*================= Size Options =============== */
  .size-options {
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .size-options label {
    font-family: 'Jost', sans-serif;
    font-weight: 400;
    font-size: 15px;
    color: #333333;
  }

  .dropdown-btn {
    padding: 12px 35px 12px 12px;
    border: 1px solid #000;
    cursor: pointer;
    width: 100%;
    text-align: left;
    background: #fff;
    font-size: 18px;
    position: relative;
  }
  .dropdown-btn svg {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;   /* Ø²ÙˆØ¯ Ø§Ù„Ø­Ø¬Ù… */
    height: 20px;
    pointer-events: none; /* Ø¹Ù„Ø´Ø§Ù† Ø§Ù„ÙƒÙ„ÙŠÙƒ ÙŠÙØ¶Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±Ø§Ø± Ù…Ø´ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
  }
  .dropdown-btn.active svg {
    transform: translateY(-50%) rotate(180deg);
  }


  .dropdown-list {
    display: none;
    flex-direction: column;
    border: 1px solid #000;
  }

  .dropdown-list button {
    padding: 10px;
    border: none;
    background: #fff;
    cursor: pointer;
    text-align: left;
  }

  .dropdown-list button:hover {
    background: #f0f0f0;
  }

  /*================= Add to Cart =============== */
  #addToCartBtn {
    background: #000;
    color: #fff;
    border: none;
    padding: 18px 15px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 2px;
    margin-top: 40px;
    width: 100%;
    letter-spacing:1px;

      position: relative;
      display: flex;
      justify-content: center; /* ÙŠÙØ¶Ù„ÙˆØ§ ÙÙŠ Ø§Ù„Ù†Øµ Ø£ÙÙ‚ÙŠÙ‹Ø§ */
      align-items: center;   /* ÙŠÙˆØ³Ø· Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ø³Ù‡Ù… Ø¹Ù…ÙˆØ¯ÙŠÙ‹Ø§ */
  }

  #addToCartBtn .addToCartBtn-text {
    position: absolute; /* ÙŠÙØ¶Ù„ Ø«Ø§Ø¨Øª ÙÙŠ Ø§Ù„Ù†Øµ */
    left: 50%;
    transform: translateX(-50%);
  }

  #addToCartBtn .addToCartBtn-icon {
    position: absolute;
    right: 35px;   /* ØªØªØ­ÙƒÙ… Ù‡Ù†Ø§ ÙÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ù‡Ù… Ø¹Ù† Ø§Ù„Ø­Ø§ÙØ© */
    top: 50%;
    transform: translateY(-50%); /* ÙŠØªÙˆØ³Ø·Ù† Ø¹Ù…ÙˆØ¯ÙŠ */
}
{% comment %} 
  #addToCartBtn svg {
    transform: none; 
    margin: 0;
  } {% endcomment %}
  /*================= Plus Btn =============== */
  .plus-btn {
    position: absolute;
    transform: translate(-50%, -50%);
    background: transparent;
    border: none;
    cursor: pointer;
    {% comment %} border-radius: 50%;
    width: 25px;
    height: 25px;
    font-size: 15px; {% endcomment %}
    padding:0;
  }
  .plus-icon {
    width: 30px;
    height: 30px;
    color: white;
  }
</style>

<script>
  let currentProduct = null;

  // Open modal when clicking plus
      document.querySelectorAll('.plus-btn').forEach((btn) => {
      btn.addEventListener('click', async () => {
      const handle = btn.dataset.handle;
      const response = await fetch(`/products/${handle}.js`);
      const product = await response.json();

      currentProduct = product;

      document.getElementById('modalTitle').textContent = product.title;
      document.getElementById('modalPrice').textContent = product.price / 100 + ' â‚¬';
      document.getElementById('modalDescription').innerHTML = product.description;
      document.getElementById('modalImage').src = product.images[0];

      // colors
      const colorContainer = document.getElementById('colorContainer');
      colorContainer.innerHTML = '';

      const colorOption = product.options.find((opt) => opt.name.toLowerCase() === 'color');

      if (colorOption) {
        colorOption.values.forEach((color, i) => {
          const colorBtn = document.createElement('button');
          colorBtn.textContent = color;
          colorBtn.classList.add('color-btn');
          if (i === 0) colorBtn.classList.add('active');

          colorBtn.addEventListener('click', () => {
            document.querySelectorAll('.color-btn').forEach((b) => b.classList.remove('active'));
            colorBtn.classList.add('active');
          });

          colorContainer.appendChild(colorBtn);
        });
      }
       

      // sizes dropdown
      const dropdownList = document.getElementById('sizeDropdownList');
      dropdownList.innerHTML = '';

      const sizeOption = product.options.find((opt) => opt.name.toLowerCase() === 'size');
      if (sizeOption) {
        sizeOption.values.forEach((size) => {
          let btn = document.createElement('button');
          btn.textContent = size;
          btn.addEventListener('click', () => {
            document.getElementById('sizeDropdownBtn').textContent = size;
            dropdownList.style.display = 'none';
          });
          dropdownList.appendChild(btn);
        });
      }

      document.getElementById('myModal').style.display = 'block';
    });
  });

  // Toggle size dropdown
  document.getElementById('sizeDropdownBtn').addEventListener('click', () => {
    const list = document.getElementById('sizeDropdownList');
    const btn = document.getElementById('sizeDropdownBtn');
    if (list.style.display === 'flex') {
      list.style.display = 'none';
      btn.classList.remove('active');
    } else {
      list.style.display = 'flex';
      btn.classList.add('active');
    }

    {% comment %} list.style.display = list.style.display === 'flex' ? 'none' : 'flex'; {% endcomment %}
  });

  // Add to cart
  document.getElementById('addToCartBtn').addEventListener('click', () => {
    if (!currentProduct) {
      alert('No product selected');
      return;
    }

    const selectedColorBtn = document.querySelector('.color-btn.active');
    const selectedColor = selectedColorBtn ? selectedColorBtn.textContent : null;

    const selectedSize =
      document.getElementById('sizeDropdownBtn').textContent !== 'Choose your size'
        ? document.getElementById('sizeDropdownBtn').textContent
        : null;

    const selectedVariant = currentProduct.variants.find((v) => {
      return (
        (!selectedColor || v.options.includes(selectedColor)) && (!selectedSize || v.options.includes(selectedSize))
      );
    });

    if (!selectedVariant) {
      alert('Please select options');
      return;
    }

    fetch('/cart/add.js', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', Accept: 'application/json' },
      body: JSON.stringify({ id: selectedVariant.id, quantity: 1 }),
    })
      .then((res) => res.json())
      .then(() => {
        document.getElementById('myModal').style.display = 'none';
      });
  });

  // Close modal
  document.querySelector('.closeFromSvg').addEventListener('click', () => {
    document.getElementById('myModal').style.display = 'none';
  });

  // Close model ESC
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      document.getElementById('myModal').style.display = 'none';
    }
  });

  window.addEventListener('click', (e) => {
    const modal = document.getElementById('myModal');
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  });
</script>
